---
title: "Project Proposal"
output: html_document
---

# Data Sets

For the project proposal, you need to describe the data sets that you and your group will work on. You also need to include the link or source from that you obtain these data sets.

[Austin Animal Center Intakes](https://data.austintexas.gov/Health-and-Community-Services/Austin-Animal-Center-Intakes/wter-evkm/about_data):

-   This dataset logs all of the Austin Animal Shelter Intakes (the animals that enters the shelter), and keeps track of the time the animal was taken in, where it was found, the intake type (stray, owner surrenders, etc), intake conditions of the animal, what type/breed the animal is, age upon intake, and a color description of the animal. The dataset begins from Oct 1st, 2013, and is updated regularly.Â 

[Austin Animal Center Outcomes](https://data.austintexas.gov/Health-and-Community-Services/Austin-Animal-Center-Outcomes/9t4d-g238/about_data):

-   This dataset mirrors the Intakes dataset, except it records data about the animals that leave the shelter, whether it is because of an adoption, transfer (of shelter/facilities), or euthanasia. This dataset has the same variables as the intakes dataset, with the addition of the outcome type (in place of intake type/condition), and has date of birth as well.

For this project, because of the immense size of the data set, we will be using only data from 2024 (Jan 1-Dec 31, 2024). Our final dataset will join the intakes and outcomes dataset into one that only has information about animals that were taken in and left the shelter in 2024, with the key variables: Intake Type, Intake Condition, Animal Type, Sex (including if they were spayed/neutered), Age, Outcome Type, Outcome Date, Date of Birth, and Length of Stay (which was calculated from the outcome date - intake date).

Here is a sample of our final dataset:

```{r include=F}
# load in libraries
library(tidyverse)
library(dplyr)

#Load in datasets and initial cleaning
outcomes <- read_csv("Austin_Animal_Center_Outcomes_20250203.csv")
intakes <- read_csv("Austin_Animal_Center_Intakes_20250203.csv")

outcomes_clean <- outcomes |> mutate(OutcomeDate = as.Date(DateTime, '%m/%d/%Y %H:%M:%S')) |>
  select(-c(DateTime, MonthYear, `Outcome Subtype`, Name, `Animal Type`, Breed, Color))
intakes_clean <- intakes |>  mutate(IntakeDate = as.Date(DateTime, '%m/%d/%Y %H:%M:%S')) |> select(-c(DateTime, MonthYear))


#inner join the datasets, and remove the duplicate rows from the multiple stays
data <- merge(intakes_clean, outcomes_clean, by="Animal ID")

#Clean up merged dataset
clean <- data |>
  group_by(`Animal ID`) |>
  mutate(LengthofStay = OutcomeDate - IntakeDate) |>
  group_by(`Animal ID`) |>
  mutate(drop = LengthofStay < 0 |(LengthofStay >= max(LengthofStay) & n() > 1)) |>
  ungroup() |>
  filter(drop == F) |>
  select(-c("drop"))

shelter_clean <- clean |>
  mutate(DOB = as.Date(`Date of Birth`, '%m/%d/%Y'),
         LengthofStay = as.numeric(LengthofStay),
         Age = case_when(
           str_detect(`Age upon Outcome`, "years") ~ as.numeric(gsub(" years", "", `Age upon Outcome`)),
           str_detect(`Age upon Outcome`, "months") ~ as.numeric(gsub(" months", "", `Age upon Outcome`))/12,
           str_detect(`Age upon Outcome`, "year") ~ as.numeric(1),
           str_detect(`Age upon Outcome`, "month") ~ as.numeric(1/12),
           str_detect(`Age upon Outcome`, "weeks") ~ as.numeric(gsub(" weeks", "", `Age upon Outcome`))/52,
           str_detect(`Age upon Outcome`, "week") ~ 1/52,
           str_detect(`Age upon Outcome`, "days") ~ as.numeric(gsub(" days", "", `Age upon Outcome`))/365,
           str_detect(`Age upon Outcome`, "day") ~ 1/365,
         )) |>
  select(`Animal ID`, Name, IntakeType = `Intake Type`, IntakeCondition = `Intake Condition`, AnimalType=`Animal Type`, Sex = `Sex upon Intake`, Age, OutcomeType=`Outcome Type`, OutcomeDate, LengthofStay, DOB)

shelter_clean$AnimalType <- as.factor(shelter_clean$AnimalType)
shelter_clean$Sex <- as.factor(shelter_clean$Sex)
shelter_clean$IntakeCondition <- as.factor(case_when(
  shelter_clean$IntakeCondition %in% c("Sick", "Agonal", "Injured", "Med Attn", "Med Urgent", "Medical", "Neurologic", "Parvo") ~ "Medical",
  shelter_clean$IntakeCondition %in% c("Other", "Unknown") ~ "Other",
  TRUE ~ as.character(shelter_clean$IntakeCondition)
))
shelter_clean <- shelter_clean |> mutate(log_LOS = log(1+LengthofStay), log_Age = log(1+Age, 10), sqrt_Age = log(1+sqrt(Age)))
```

```{r echo=F}
head(shelter_clean)
```

# Questions

For each question, you need to include initial results, such as figures/ plots and some simple analyses (e.g., linear and non-linear models, tree-based methods, etc.).

## Q1 - Using the available predictors, is it possible to predict the length of stay of an animal that comes into the Austin animal shelter?

## Q2

## Q3

## Q4
